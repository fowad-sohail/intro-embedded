


ARM Macro Assembler    Page 1 


    1 00000000         ; Port 1 Pin Direction Register
    2 00000000 40004C04 
                       P1DIR   EQU              0x40004C04
    3 00000000         ; Port 1 Pin Output Register
    4 00000000 40004C02 
                       P1OUT   EQU              0x40004C02
    5 00000000 40004C00 
                       P1IN    EQU              0x40004C00
    6 00000000 40004C06 
                       P1REN   EQU              0x40004C06
    7 00000000         
    8 00000000 40004C07 
                       P2REN   EQU              0x40004C07  ; resistor enable
    9 00000000 40004C05 
                       P2DIR   EQU              0x40004C05
   10 00000000 40004C03 
                       P2OUT   EQU              0x40004C03
   11 00000000 40004C01 
                       P2IN    EQU              0x40004C01
   12 00000000         
   13 00000000 00000010 
                       YELLOWmask
                               EQU              0x10        ; bitmask P2.4
   14 00000000         
   15 00000000 00000002 
                       TSTmask EQU              0x2         ; bitmask P1.1
   16 00000000 00000010 
                       ACKmask EQU              0x10        ; bitmask P1.4
   17 00000000 00000040 
                       FLAmask EQU              0x40        ; bitmask P2.6
   18 00000000 00000080 
                       OLAmask EQU              0x80        ; bitmask P2.7
   19 00000000         
   20 00000000         
   21 00000000         
   22 00000000                 THUMB
   23 00000000                 AREA             |.text|, CODE, READONLY, ALIGN=
2
   24 00000000                 EXPORT           asm_main
   25 00000000         
   26 00000000         asm_main
   27 00000000 483F            LDR              R0, =P2DIR
   28 00000002 7801            LDRB             R1, [R0]
   29 00000004 F041 01FF       ORR              R1, #255
   30 00000008 7001            STRB             R1, [R0]
   31 0000000A         
   32 0000000A         ; make pin 2.6 pull up configured
   33 0000000A         ;  LDR     R0, =P2REN
   34 0000000A         ;        LDRB    R1, [R0]
   35 0000000A         ;        ORR     R1, #64          
   36 0000000A         ;        STRB    R1, [R0] 
   37 0000000A         
   38 0000000A         
   39 0000000A         
   40 0000000A 483E            LDR              R0, =P1DIR
   41 0000000C 7801            LDRB             R1, [R0]
   42 0000000E F041 01FF       ORR              R1, #255
   43 00000012 7001            STRB             R1, [R0]
   44 00000014         



ARM Macro Assembler    Page 2 


   45 00000014         ; TIM CODE
   46 00000014 483C            LDR              R0, =P2REN  ; load Dir Reg in R
                                                            1
   47 00000016 7801            LDRB             R1, [R0]    ;
   48 00000018 F041 0140       ORR              R1, FLAmask ; set bit
   49 0000001C 7001            STRB             R1, [R0]    ; store back to Dir
                                                             Reg
   50 0000001E         
   51 0000001E 483B            LDR              R0, =P2OUT  ; load Dir Reg in R
                                                            1
   52 00000020 7801            LDRB             R1, [R0]    ;
   53 00000022 F041 0140       ORR              R1, FLAmask ; set bit
   54 00000026 7001            STRB             R1, [R0]    ; store back to Dir
                                                             Reg
   55 00000028         
   56 00000028         
   57 00000028         
   58 00000028         ; RYAN BROKEN CODE
   59 00000028         ;  ; make P1.[1, 4, 6, 7] inputs pins
   60 00000028         ;  LDR     R0, =P1DIR      
   61 00000028         ;        LDRB    R1, [R0]
   62 00000028         ;        MVN  R2, #0xD2
   63 00000028         ;  AND  R1, R2
   64 00000028         ;        STRB    R1, [R0]
   65 00000028         ;  
   66 00000028         ;  ; enable pull configuration P1.1, P1.4
   67 00000028         ;  LDR R0, =P1REN
   68 00000028         ;  LDRB R1, [R0]
   69 00000028         ;  ORR R1, #0x12
   70 00000028         ;  STRB R1, [R0]
   71 00000028         ;  
   72 00000028         ;  ; P1.1 pull up resistor
   73 00000028         ;  LDR R0, =P1OUT
   74 00000028         ;  LDRB R1, [R0]
   75 00000028         ;  ORR R1, #0x12
   76 00000028         ;  STRB R1, [R0]
   77 00000028         
   78 00000028         
   79 00000028         loop
   80 00000028 F000 F861       BL               allOFF
   81 0000002C         
   82 0000002C         ; start in state b
   83 0000002C F000 F812       BL               stateB
   84 00000030         
   85 00000030         
   86 00000030         
   87 00000030 E7FA            B                loop        ; repeat the loop
   88 00000032         
   89 00000032         ;-------------------------------------------------------
                       ------------------------
   90 00000032         ; STATES
   91 00000032         stateA
   92 00000032 F000 F832       BL               greenON
   93 00000036 F000 F83E       BL               yellowON
   94 0000003A F000 F84A       BL               redON
   95 0000003E         
   96 0000003E 4834            LDR              R0, =500000
   97 00000040 F000 F828       BL               delayMs
   98 00000044         



ARM Macro Assembler    Page 3 


   99 00000044 F000 F83D       BL               yellowOFF
  100 00000048 F000 F849       BL               redOFF
  101 0000004C         
  102 0000004C 4830            LDR              R0, =500000
  103 0000004E F000 F821       BL               delayMs
  104 00000052         
  105 00000052 E7EE            B                stateA
  106 00000054         
  107 00000054         
  108 00000054         stateB
  109 00000054 F000 F821       BL               greenON
  110 00000058 F000 F833       BL               yellowOFF
  111 0000005C F000 F83F       BL               redOFF
  112 00000060         
  113 00000060         ; to get to stateC
  114 00000060 482C            LDR              r0, =P2IN
  115 00000062 7801            LDRB             r1, [r0]
  116 00000064 F011 0F40       TST              r1, FLAmask
  117 00000068 D005            BEQ              stateC
  118 0000006A         
  119 0000006A         ; to get to stateA
  120 0000006A 482B            LDR              r0, =P1IN
  121 0000006C 7801            LDRB             r1, [r0]
  122 0000006E F011 0F02       TST              r1, TSTmask
  123 00000072 D0DE            BEQ              stateA
  124 00000074         
  125 00000074 E7EE            B                stateB
  126 00000076         
  127 00000076         stateC
  128 00000076 F000 F816       BL               greenOFF
  129 0000007A F000 F830       BL               redOFF      ; red shouldnt be o
                                                            n in stateB, but tu
                                                            rn it off as a fail
                                                            safe
  130 0000007E F000 F81A       BL               yellowON
  131 00000082         
  132 00000082 4823            LDR              R0, =500000
  133 00000084 F000 F806       BL               delayMs
  134 00000088         
  135 00000088 F000 F81B       BL               yellowOFF
  136 0000008C         
  137 0000008C 4820            LDR              R0, =500000
  138 0000008E F000 F801       BL               delayMs
  139 00000092         
  140 00000092 E7F0            B                stateC
  141 00000094         
  142 00000094         ; ------------------------------------------------------
                       ------------------------
  143 00000094         ; SUBROUTINES
  144 00000094         delayMs
  145 00000094         
  146 00000094 3801    L1      SUBS             R0, #1      ; inner loop
  147 00000096 D1FD            BNE              L1
  148 00000098 4770            BX               LR
  149 0000009A         
  150 0000009A         greenON
  151 0000009A 481C            LDR              R0, =P2OUT  ; load Output Data 
                                                            Reg in R1
  152 0000009C 7801            LDRB             R1, [R0]



ARM Macro Assembler    Page 4 


  153 0000009E F041 0102       ORR              R1, #2      ; set bit 0
  154 000000A2 7001            STRB             R1, [R0]    ; store back to Out
                                                            put Data Reg
  155 000000A4 4770            BX               LR
  156 000000A6         
  157 000000A6         greenOFF
  158 000000A6 4819            LDR              R0, =P2OUT  ; load Output Data 
                                                            Reg in R1
  159 000000A8 7801            LDRB             R1, [R0]
  160 000000AA F06F 0202       MVN              R2, #2      ; load complement o
                                                            f bit 0 mask
  161 000000AE EA01 0102       AND              R1, R2      ; clear bit 0
  162 000000B2 7001            STRB             R1, [R0]    ; store back to Out
                                                            put Data Reg
  163 000000B4 4770            BX               LR
  164 000000B6         
  165 000000B6         yellowON
  166 000000B6 4815            LDR              R0, =P2OUT  ; load Output Data 
                                                            Reg in R1
  167 000000B8 7801            LDRB             R1, [R0]
  168 000000BA F041 0110       ORR              R1, YELLOWmask
  169 000000BE 7001            STRB             R1, [R0]    ; store back to Out
                                                            put Data Reg
  170 000000C0 4770            BX               LR
  171 000000C2         
  172 000000C2         yellowOFF
  173 000000C2 4812            LDR              R0, =P2OUT  ; load Output Data 
                                                            Reg in R1
  174 000000C4 7801            LDRB             R1, [R0]
  175 000000C6 F06F 0210       MVN              R2, YELLOWmask ; load complemen
                                                            t of bit 0 mask
  176 000000CA EA01 0102       AND              R1, R2      ; clear bit 0
  177 000000CE 7001            STRB             R1, [R0]    ; store back to Out
                                                            put Data Reg
  178 000000D0 4770            BX               LR
  179 000000D2         
  180 000000D2         redON
  181 000000D2 4812            LDR              R0, =P1OUT  ; load Output Data 
                                                            Reg in R1
  182 000000D4 7801            LDRB             R1, [R0]
  183 000000D6 F041 0101       ORR              R1, #1      ; set bit 0
  184 000000DA 7001            STRB             R1, [R0]    ; store back to Out
                                                            put Data Reg
  185 000000DC 4770            BX               LR
  186 000000DE         
  187 000000DE         redOFF
  188 000000DE 480F            LDR              R0, =P1OUT  ; load Output Data 
                                                            Reg in R1
  189 000000E0 7801            LDRB             R1, [R0]
  190 000000E2 F06F 0201       MVN              R2, #1      ; load complement o
                                                            f bit 0 mask
  191 000000E6 EA01 0102       AND              R1, R2      ; clear bit 0
  192 000000EA 7001            STRB             R1, [R0]    ; store back to Out
                                                            put Data Reg
  193 000000EC 4770            BX               LR
  194 000000EE         
  195 000000EE         allOFF
  196 000000EE 4807            LDR              R0, =P2OUT  ; load Output Data 
                                                            Reg in R1



ARM Macro Assembler    Page 5 


  197 000000F0 7801            LDRB             R1, [R0]
  198 000000F2 F06F 0207       MVN              R2, #7      ; load complement o
                                                            f bit 0 mask
  199 000000F6 EA01 0102       AND              R1, R2      ; clear bit 0
  200 000000FA 7001            STRB             R1, [R0]    ; store back to Out
                                                            put Data Reg
  201 000000FC 4770            BX               LR
  202 000000FE         
  203 000000FE                 END
              00 00 40004C05 
              40004C04 
              40004C07 
              40004C03 
              0007A120 
              40004C01 
              40004C00 
              40004C02 
Command Line: --debug --xref --diag_suppress=9931 --cpu=Cortex-M4.fp --apcs=int
erwork --depend=.\objects\asm_main.d -o.\objects\asm_main.o -I.\RTE\_Target_1 -
IC:\Users\fssoh\AppData\Local\Arm\Packs\ARM\CMSIS\5.6.0\CMSIS\Core\Include -IC:
\Users\fssoh\AppData\Local\Arm\Packs\TexasInstruments\MSP432P4xx_DFP\3.2.6\Devi
ce\Include --predefine="__EVAL SETA 1" --predefine="__UVISION_VERSION SETA 528"
 --predefine="_RTE_ SETA 1" --predefine="__MSP432P401R__ SETA 1" --list=.\listi
ngs\asm_main.lst asm_main.s



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

.text 00000000

Symbol: .text
   Definitions
      At line 23 in file asm_main.s
   Uses
      None
Comment: .text unused
L1 00000094

Symbol: L1
   Definitions
      At line 146 in file asm_main.s
   Uses
      At line 147 in file asm_main.s
Comment: L1 used once
allOFF 000000EE

Symbol: allOFF
   Definitions
      At line 195 in file asm_main.s
   Uses
      At line 80 in file asm_main.s
Comment: allOFF used once
asm_main 00000000

Symbol: asm_main
   Definitions
      At line 26 in file asm_main.s
   Uses
      At line 24 in file asm_main.s
Comment: asm_main used once
delayMs 00000094

Symbol: delayMs
   Definitions
      At line 144 in file asm_main.s
   Uses
      At line 97 in file asm_main.s
      At line 103 in file asm_main.s
      At line 133 in file asm_main.s
      At line 138 in file asm_main.s

greenOFF 000000A6

Symbol: greenOFF
   Definitions
      At line 157 in file asm_main.s
   Uses
      At line 128 in file asm_main.s
Comment: greenOFF used once
greenON 0000009A

Symbol: greenON
   Definitions
      At line 150 in file asm_main.s
   Uses
      At line 92 in file asm_main.s
      At line 109 in file asm_main.s



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Relocatable symbols


loop 00000028

Symbol: loop
   Definitions
      At line 79 in file asm_main.s
   Uses
      At line 87 in file asm_main.s
Comment: loop used once
redOFF 000000DE

Symbol: redOFF
   Definitions
      At line 187 in file asm_main.s
   Uses
      At line 100 in file asm_main.s
      At line 111 in file asm_main.s
      At line 129 in file asm_main.s

redON 000000D2

Symbol: redON
   Definitions
      At line 180 in file asm_main.s
   Uses
      At line 94 in file asm_main.s
Comment: redON used once
stateA 00000032

Symbol: stateA
   Definitions
      At line 91 in file asm_main.s
   Uses
      At line 105 in file asm_main.s
      At line 123 in file asm_main.s

stateB 00000054

Symbol: stateB
   Definitions
      At line 108 in file asm_main.s
   Uses
      At line 83 in file asm_main.s
      At line 125 in file asm_main.s

stateC 00000076

Symbol: stateC
   Definitions
      At line 127 in file asm_main.s
   Uses
      At line 117 in file asm_main.s
      At line 140 in file asm_main.s

yellowOFF 000000C2

Symbol: yellowOFF
   Definitions
      At line 172 in file asm_main.s



ARM Macro Assembler    Page 3 Alphabetic symbol ordering
Relocatable symbols

   Uses
      At line 99 in file asm_main.s
      At line 110 in file asm_main.s
      At line 135 in file asm_main.s

yellowON 000000B6

Symbol: yellowON
   Definitions
      At line 165 in file asm_main.s
   Uses
      At line 93 in file asm_main.s
      At line 130 in file asm_main.s

15 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Absolute symbols

ACKmask 00000010

Symbol: ACKmask
   Definitions
      At line 16 in file asm_main.s
   Uses
      None
Comment: ACKmask unused
FLAmask 00000040

Symbol: FLAmask
   Definitions
      At line 17 in file asm_main.s
   Uses
      At line 48 in file asm_main.s
      At line 53 in file asm_main.s
      At line 116 in file asm_main.s

OLAmask 00000080

Symbol: OLAmask
   Definitions
      At line 18 in file asm_main.s
   Uses
      None
Comment: OLAmask unused
P1DIR 40004C04

Symbol: P1DIR
   Definitions
      At line 2 in file asm_main.s
   Uses
      At line 40 in file asm_main.s
Comment: P1DIR used once
P1IN 40004C00

Symbol: P1IN
   Definitions
      At line 5 in file asm_main.s
   Uses
      At line 120 in file asm_main.s
Comment: P1IN used once
P1OUT 40004C02

Symbol: P1OUT
   Definitions
      At line 4 in file asm_main.s
   Uses
      At line 181 in file asm_main.s
      At line 188 in file asm_main.s

P1REN 40004C06

Symbol: P1REN
   Definitions
      At line 6 in file asm_main.s
   Uses
      None
Comment: P1REN unused



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Absolute symbols

P2DIR 40004C05

Symbol: P2DIR
   Definitions
      At line 9 in file asm_main.s
   Uses
      At line 27 in file asm_main.s
Comment: P2DIR used once
P2IN 40004C01

Symbol: P2IN
   Definitions
      At line 11 in file asm_main.s
   Uses
      At line 114 in file asm_main.s
Comment: P2IN used once
P2OUT 40004C03

Symbol: P2OUT
   Definitions
      At line 10 in file asm_main.s
   Uses
      At line 51 in file asm_main.s
      At line 151 in file asm_main.s
      At line 158 in file asm_main.s
      At line 166 in file asm_main.s
      At line 173 in file asm_main.s
      At line 196 in file asm_main.s

P2REN 40004C07

Symbol: P2REN
   Definitions
      At line 8 in file asm_main.s
   Uses
      At line 46 in file asm_main.s
Comment: P2REN used once
TSTmask 00000002

Symbol: TSTmask
   Definitions
      At line 15 in file asm_main.s
   Uses
      At line 122 in file asm_main.s
Comment: TSTmask used once
YELLOWmask 00000010

Symbol: YELLOWmask
   Definitions
      At line 13 in file asm_main.s
   Uses
      At line 168 in file asm_main.s
      At line 175 in file asm_main.s

13 symbols
365 symbols in table




ARM Macro Assembler    Page 1 


    1 00000000         ; Port 1 Pin Direction Register
    2 00000000 40004C04 
                       P1DIR   EQU              0x40004C04
    3 00000000         ; Port 1 Pin Output Register
    4 00000000 40004C02 
                       P1OUT   EQU              0x40004C02
    5 00000000 40004C00 
                       P1IN    EQU              0x40004C00
    6 00000000 40004C06 
                       P1REN   EQU              0x40004C06
    7 00000000         
    8 00000000 40004C07 
                       P2REN   EQU              0x40004C07  ; resistor enable
    9 00000000 40004C05 
                       P2DIR   EQU              0x40004C05
   10 00000000 40004C03 
                       P2OUT   EQU              0x40004C03
   11 00000000 40004C01 
                       P2IN    EQU              0x40004C01
   12 00000000         
   13 00000000 00000010 
                       YELLOWmask
                               EQU              0x10        ; bitmask P2.4
   14 00000000         
   15 00000000 00000002 
                       TSTmask EQU              0x2         ; bitmask P1.1
   16 00000000 00000010 
                       ACKmask EQU              0x10        ; bitmask P1.4
   17 00000000 00000040 
                       FLAmask EQU              0x40        ; bitmask P2.6
   18 00000000 00000080 
                       OLAmask EQU              0x80        ; bitmask P2.7
   19 00000000         
   20 00000000         
   21 00000000         
   22 00000000                 THUMB
   23 00000000                 AREA             |.text|, CODE, READONLY, ALIGN=
2
   24 00000000                 EXPORT           asm_main
   25 00000000         
   26 00000000         asm_main
   27 00000000 484B            LDR              R0, =P2DIR
   28 00000002 7801            LDRB             R1, [R0]
   29 00000004 F041 01FF       ORR              R1, #255
   30 00000008 7001            STRB             R1, [R0]
   31 0000000A         
   32 0000000A 484A            LDR              R0, =P1DIR
   33 0000000C 7801            LDRB             R1, [R0]
   34 0000000E F041 01FF       ORR              R1, #255
   35 00000012 7001            STRB             R1, [R0]
   36 00000014         
   37 00000014 4848            LDR              R0, =P2REN  ; load Dir Reg in R
                                                            1
   38 00000016 7801            LDRB             R1, [R0]    ;
   39 00000018 F041 0140       ORR              R1, FLAmask ; set bit
   40 0000001C 7001            STRB             R1, [R0]    ; store back to Dir
                                                             Reg
   41 0000001E         
   42 0000001E 4847            LDR              R0, =P2OUT  ; load Dir Reg in R



ARM Macro Assembler    Page 2 


                                                            1
   43 00000020 7801            LDRB             R1, [R0]    ;
   44 00000022 F041 0140       ORR              R1, FLAmask ; set bit
   45 00000026 7001            STRB             R1, [R0]    ; store back to Dir
                                                             Reg
   46 00000028         
   47 00000028         loop
   48 00000028 F000 F87A       BL               allOFF
   49 0000002C         
   50 0000002C         ; start in state b
   51 0000002C F000 F817       BL               stateB
   52 00000030         
   53 00000030 E7FA            B                loop        ; repeat the loop
   54 00000032         
   55 00000032         ;-------------------------------------------------------
                       ------------------------
   56 00000032         ; STATES
   57 00000032         stateA
   58 00000032         ; to get to stateB
   59 00000032 4843            LDR              r0, =P1IN
   60 00000034 7801            LDRB             r1, [r0]
   61 00000036 F011 0F02       TST              r1, TSTmask
   62 0000003A D110            BNE              stateB
   63 0000003C         
   64 0000003C F000 F846       BL               greenON
   65 00000040 F000 F852       BL               yellowON
   66 00000044 F000 F85E       BL               redON
   67 00000048         
   68 00000048 483E            LDR              R0, =500000
   69 0000004A F000 F83C       BL               delayMs
   70 0000004E         
   71 0000004E F000 F851       BL               yellowOFF
   72 00000052 F000 F85D       BL               redOFF
   73 00000056         
   74 00000056 483B            LDR              R0, =500000
   75 00000058 F000 F835       BL               delayMs
   76 0000005C         
   77 0000005C E7E9            B                stateA
   78 0000005E         
   79 0000005E         stateB
   80 0000005E F000 F835       BL               greenON
   81 00000062 F000 F847       BL               yellowOFF
   82 00000066 F000 F853       BL               redOFF
   83 0000006A         
   84 0000006A         ; to get to stateC
   85 0000006A 4837            LDR              r0, =P2IN
   86 0000006C 7801            LDRB             r1, [r0]
   87 0000006E F011 0F40       TST              r1, FLAmask
   88 00000072 D005            BEQ              stateC
   89 00000074         
   90 00000074         ; to get to stateA
   91 00000074 4832            LDR              r0, =P1IN
   92 00000076 7801            LDRB             r1, [r0]
   93 00000078 F011 0F02       TST              r1, TSTmask
   94 0000007C D0D9            BEQ              stateA
   95 0000007E         
   96 0000007E E7EE            B                stateB
   97 00000080         
   98 00000080         stateC



ARM Macro Assembler    Page 3 


   99 00000080         ; to get to stateE
  100 00000080 4831            LDR              r0, =P2IN
  101 00000082 7801            LDRB             r1, [r0]
  102 00000084 F011 0F80       TST              r1, OLAmask
  103 00000088 D00E            BEQ              stateE
  104 0000008A         
  105 0000008A F000 F825       BL               greenOFF
  106 0000008E F000 F83F       BL               redOFF      ; red shouldnt be o
                                                            n in stateB, but tu
                                                            rn it off as a fail
                                                            safe
  107 00000092 F000 F829       BL               yellowON
  108 00000096         
  109 00000096 482B            LDR              R0, =500000
  110 00000098 F000 F815       BL               delayMs
  111 0000009C         
  112 0000009C F000 F82A       BL               yellowOFF
  113 000000A0         
  114 000000A0 4828            LDR              R0, =500000
  115 000000A2 F000 F810       BL               delayMs
  116 000000A6         
  117 000000A6 E7EB            B                stateC
  118 000000A8         
  119 000000A8         stateE
  120 000000A8 F000 F816       BL               greenOFF
  121 000000AC F000 F822       BL               yellowOFF
  122 000000B0 F000 F828       BL               redON
  123 000000B4         
  124 000000B4 4823            LDR              R0, =500000
  125 000000B6 F000 F806       BL               delayMs
  126 000000BA         
  127 000000BA F000 F829       BL               redOFF
  128 000000BE         
  129 000000BE 4821            LDR              R0, =500000
  130 000000C0 F000 F801       BL               delayMs
  131 000000C4         
  132 000000C4 E7F0            B                stateE
  133 000000C6         
  134 000000C6         ; ------------------------------------------------------
                       ------------------------
  135 000000C6         ; SUBROUTINES
  136 000000C6         delayMs
  137 000000C6         
  138 000000C6 3801    L1      SUBS             R0, #1      ; inner loop
  139 000000C8 D1FD            BNE              L1
  140 000000CA 4770            BX               LR
  141 000000CC         
  142 000000CC         greenON
  143 000000CC 481B            LDR              R0, =P2OUT  ; load Output Data 
                                                            Reg in R1
  144 000000CE 7801            LDRB             R1, [R0]
  145 000000D0 F041 0102       ORR              R1, #2      ; set bit 0
  146 000000D4 7001            STRB             R1, [R0]    ; store back to Out
                                                            put Data Reg
  147 000000D6 4770            BX               LR
  148 000000D8         
  149 000000D8         greenOFF
  150 000000D8 4818            LDR              R0, =P2OUT  ; load Output Data 
                                                            Reg in R1



ARM Macro Assembler    Page 4 


  151 000000DA 7801            LDRB             R1, [R0]
  152 000000DC F06F 0202       MVN              R2, #2      ; load complement o
                                                            f bit 0 mask
  153 000000E0 EA01 0102       AND              R1, R2      ; clear bit 0
  154 000000E4 7001            STRB             R1, [R0]    ; store back to Out
                                                            put Data Reg
  155 000000E6 4770            BX               LR
  156 000000E8         
  157 000000E8         yellowON
  158 000000E8 4814            LDR              R0, =P2OUT  ; load Output Data 
                                                            Reg in R1
  159 000000EA 7801            LDRB             R1, [R0]
  160 000000EC F041 0110       ORR              R1, YELLOWmask
  161 000000F0 7001            STRB             R1, [R0]    ; store back to Out
                                                            put Data Reg
  162 000000F2 4770            BX               LR
  163 000000F4         
  164 000000F4         yellowOFF
  165 000000F4 4811            LDR              R0, =P2OUT  ; load Output Data 
                                                            Reg in R1
  166 000000F6 7801            LDRB             R1, [R0]
  167 000000F8 F06F 0210       MVN              R2, YELLOWmask ; load complemen
                                                            t of bit 0 mask
  168 000000FC EA01 0102       AND              R1, R2      ; clear bit 0
  169 00000100 7001            STRB             R1, [R0]    ; store back to Out
                                                            put Data Reg
  170 00000102 4770            BX               LR
  171 00000104         
  172 00000104         redON
  173 00000104 4811            LDR              R0, =P1OUT  ; load Output Data 
                                                            Reg in R1
  174 00000106 7801            LDRB             R1, [R0]
  175 00000108 F041 0101       ORR              R1, #1      ; set bit 0
  176 0000010C 7001            STRB             R1, [R0]    ; store back to Out
                                                            put Data Reg
  177 0000010E 4770            BX               LR
  178 00000110         
  179 00000110         redOFF
  180 00000110 480E            LDR              R0, =P1OUT  ; load Output Data 
                                                            Reg in R1
  181 00000112 7801            LDRB             R1, [R0]
  182 00000114 F06F 0201       MVN              R2, #1      ; load complement o
                                                            f bit 0 mask
  183 00000118 EA01 0102       AND              R1, R2      ; clear bit 0
  184 0000011C 7001            STRB             R1, [R0]    ; store back to Out
                                                            put Data Reg
  185 0000011E 4770            BX               LR
  186 00000120         
  187 00000120         allOFF
  188 00000120 4806            LDR              R0, =P2OUT  ; load Output Data 
                                                            Reg in R1
  189 00000122 7801            LDRB             R1, [R0]
  190 00000124 F06F 0207       MVN              R2, #7      ; load complement o
                                                            f bit 0 mask
  191 00000128 EA01 0102       AND              R1, R2      ; clear bit 0
  192 0000012C 7001            STRB             R1, [R0]    ; store back to Out
                                                            put Data Reg
  193 0000012E 4770            BX               LR
  194 00000130         



ARM Macro Assembler    Page 5 


  195 00000130                 END
              40004C05 
              40004C04 
              40004C07 
              40004C03 
              40004C00 
              0007A120 
              40004C01 
              40004C02 
Command Line: --debug --xref --diag_suppress=9931 --cpu=Cortex-M4.fp --apcs=int
erwork --depend=.\objects\asm_main.d -o.\objects\asm_main.o -I.\RTE\_Target_1 -
IC:\Users\fssoh\AppData\Local\Arm\Packs\ARM\CMSIS\5.6.0\CMSIS\Core\Include -IC:
\Users\fssoh\AppData\Local\Arm\Packs\TexasInstruments\MSP432P4xx_DFP\3.2.6\Devi
ce\Include --predefine="__EVAL SETA 1" --predefine="__UVISION_VERSION SETA 528"
 --predefine="_RTE_ SETA 1" --predefine="__MSP432P401R__ SETA 1" --list=.\listi
ngs\asm_main.lst asm_main.s



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

.text 00000000

Symbol: .text
   Definitions
      At line 23 in file asm_main.s
   Uses
      None
Comment: .text unused
L1 000000C6

Symbol: L1
   Definitions
      At line 138 in file asm_main.s
   Uses
      At line 139 in file asm_main.s
Comment: L1 used once
allOFF 00000120

Symbol: allOFF
   Definitions
      At line 187 in file asm_main.s
   Uses
      At line 48 in file asm_main.s
Comment: allOFF used once
asm_main 00000000

Symbol: asm_main
   Definitions
      At line 26 in file asm_main.s
   Uses
      At line 24 in file asm_main.s
Comment: asm_main used once
delayMs 000000C6

Symbol: delayMs
   Definitions
      At line 136 in file asm_main.s
   Uses
      At line 69 in file asm_main.s
      At line 75 in file asm_main.s
      At line 110 in file asm_main.s
      At line 115 in file asm_main.s
      At line 125 in file asm_main.s
      At line 130 in file asm_main.s

greenOFF 000000D8

Symbol: greenOFF
   Definitions
      At line 149 in file asm_main.s
   Uses
      At line 105 in file asm_main.s
      At line 120 in file asm_main.s

greenON 000000CC

Symbol: greenON
   Definitions
      At line 142 in file asm_main.s



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Relocatable symbols

   Uses
      At line 64 in file asm_main.s
      At line 80 in file asm_main.s

loop 00000028

Symbol: loop
   Definitions
      At line 47 in file asm_main.s
   Uses
      At line 53 in file asm_main.s
Comment: loop used once
redOFF 00000110

Symbol: redOFF
   Definitions
      At line 179 in file asm_main.s
   Uses
      At line 72 in file asm_main.s
      At line 82 in file asm_main.s
      At line 106 in file asm_main.s
      At line 127 in file asm_main.s

redON 00000104

Symbol: redON
   Definitions
      At line 172 in file asm_main.s
   Uses
      At line 66 in file asm_main.s
      At line 122 in file asm_main.s

stateA 00000032

Symbol: stateA
   Definitions
      At line 57 in file asm_main.s
   Uses
      At line 77 in file asm_main.s
      At line 94 in file asm_main.s

stateB 0000005E

Symbol: stateB
   Definitions
      At line 79 in file asm_main.s
   Uses
      At line 51 in file asm_main.s
      At line 62 in file asm_main.s
      At line 96 in file asm_main.s

stateC 00000080

Symbol: stateC
   Definitions
      At line 98 in file asm_main.s
   Uses
      At line 88 in file asm_main.s
      At line 117 in file asm_main.s



ARM Macro Assembler    Page 3 Alphabetic symbol ordering
Relocatable symbols


stateE 000000A8

Symbol: stateE
   Definitions
      At line 119 in file asm_main.s
   Uses
      At line 103 in file asm_main.s
      At line 132 in file asm_main.s

yellowOFF 000000F4

Symbol: yellowOFF
   Definitions
      At line 164 in file asm_main.s
   Uses
      At line 71 in file asm_main.s
      At line 81 in file asm_main.s
      At line 112 in file asm_main.s
      At line 121 in file asm_main.s

yellowON 000000E8

Symbol: yellowON
   Definitions
      At line 157 in file asm_main.s
   Uses
      At line 65 in file asm_main.s
      At line 107 in file asm_main.s

16 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Absolute symbols

ACKmask 00000010

Symbol: ACKmask
   Definitions
      At line 16 in file asm_main.s
   Uses
      None
Comment: ACKmask unused
FLAmask 00000040

Symbol: FLAmask
   Definitions
      At line 17 in file asm_main.s
   Uses
      At line 39 in file asm_main.s
      At line 44 in file asm_main.s
      At line 87 in file asm_main.s

OLAmask 00000080

Symbol: OLAmask
   Definitions
      At line 18 in file asm_main.s
   Uses
      At line 102 in file asm_main.s
Comment: OLAmask used once
P1DIR 40004C04

Symbol: P1DIR
   Definitions
      At line 2 in file asm_main.s
   Uses
      At line 32 in file asm_main.s
Comment: P1DIR used once
P1IN 40004C00

Symbol: P1IN
   Definitions
      At line 5 in file asm_main.s
   Uses
      At line 59 in file asm_main.s
      At line 91 in file asm_main.s

P1OUT 40004C02

Symbol: P1OUT
   Definitions
      At line 4 in file asm_main.s
   Uses
      At line 173 in file asm_main.s
      At line 180 in file asm_main.s

P1REN 40004C06

Symbol: P1REN
   Definitions
      At line 6 in file asm_main.s
   Uses
      None



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Absolute symbols

Comment: P1REN unused
P2DIR 40004C05

Symbol: P2DIR
   Definitions
      At line 9 in file asm_main.s
   Uses
      At line 27 in file asm_main.s
Comment: P2DIR used once
P2IN 40004C01

Symbol: P2IN
   Definitions
      At line 11 in file asm_main.s
   Uses
      At line 85 in file asm_main.s
      At line 100 in file asm_main.s

P2OUT 40004C03

Symbol: P2OUT
   Definitions
      At line 10 in file asm_main.s
   Uses
      At line 42 in file asm_main.s
      At line 143 in file asm_main.s
      At line 150 in file asm_main.s
      At line 158 in file asm_main.s
      At line 165 in file asm_main.s
      At line 188 in file asm_main.s

P2REN 40004C07

Symbol: P2REN
   Definitions
      At line 8 in file asm_main.s
   Uses
      At line 37 in file asm_main.s
Comment: P2REN used once
TSTmask 00000002

Symbol: TSTmask
   Definitions
      At line 15 in file asm_main.s
   Uses
      At line 61 in file asm_main.s
      At line 93 in file asm_main.s

YELLOWmask 00000010

Symbol: YELLOWmask
   Definitions
      At line 13 in file asm_main.s
   Uses
      At line 160 in file asm_main.s
      At line 167 in file asm_main.s

13 symbols
366 symbols in table




ARM Macro Assembler    Page 1 


    1 00000000         ; Port 1 Pin Direction Register
    2 00000000 40004C04 
                       P1DIR   EQU              0x40004C04
    3 00000000         ; Port 1 Pin Output Register
    4 00000000 40004C02 
                       P1OUT   EQU              0x40004C02
    5 00000000 40004C00 
                       P1IN    EQU              0x40004C00
    6 00000000 40004C06 
                       P1REN   EQU              0x40004C06
    7 00000000         
    8 00000000 40004C07 
                       P2REN   EQU              0x40004C07  ; resistor enable
    9 00000000 40004C05 
                       P2DIR   EQU              0x40004C05
   10 00000000 40004C03 
                       P2OUT   EQU              0x40004C03
   11 00000000 40004C01 
                       P2IN    EQU              0x40004C01
   12 00000000         
   13 00000000 00000010 
                       YELLOWmask
                               EQU              0x10        ; bitmask P2.4
   14 00000000         
   15 00000000 00000002 
                       TSTmask EQU              0x2         ; bitmask P1.1
   16 00000000 00000010 
                       ACKmask EQU              0x10        ; bitmask P1.4
   17 00000000 00000040 
                       FLAmask EQU              0x40        ; bitmask P2.6
   18 00000000 00000080 
                       OLAmask EQU              0x80        ; bitmask P2.7
   19 00000000         
   20 00000000         
   21 00000000         
   22 00000000                 THUMB
   23 00000000                 AREA             |.text|, CODE, READONLY, ALIGN=
2
   24 00000000                 EXPORT           asm_main
   25 00000000         
   26 00000000         asm_main
   27 00000000 4851            LDR              R0, =P2DIR
   28 00000002 7801            LDRB             R1, [R0]
   29 00000004 F041 01FF       ORR              R1, #255
   30 00000008 7001            STRB             R1, [R0]
   31 0000000A         
   32 0000000A 4850            LDR              R0, =P1DIR
   33 0000000C 7801            LDRB             R1, [R0]
   34 0000000E F041 01FF       ORR              R1, #255
   35 00000012 7001            STRB             R1, [R0]
   36 00000014         
   37 00000014 484E            LDR              R0, =P2REN  ; load Dir Reg in R
                                                            1
   38 00000016 7801            LDRB             R1, [R0]    ;
   39 00000018 F041 0140       ORR              R1, FLAmask ; set bit
   40 0000001C 7001            STRB             R1, [R0]    ; store back to Dir
                                                             Reg
   41 0000001E         
   42 0000001E 484D            LDR              R0, =P2OUT  ; load Dir Reg in R



ARM Macro Assembler    Page 2 


                                                            1
   43 00000020 7801            LDRB             R1, [R0]    ;
   44 00000022 F041 0140       ORR              R1, FLAmask ; set bit
   45 00000026 7001            STRB             R1, [R0]    ; store back to Dir
                                                             Reg
   46 00000028         
   47 00000028         loop
   48 00000028 F000 F886       BL               allOFF
   49 0000002C         
   50 0000002C         ; start in state b
   51 0000002C F000 F817       BL               stateB
   52 00000030         
   53 00000030 E7FA            B                loop        ; repeat the loop
   54 00000032         
   55 00000032         ;-------------------------------------------------------
                       ------------------------
   56 00000032         ; STATES
   57 00000032         stateA
   58 00000032         ; to get to stateB
   59 00000032 4849            LDR              r0, =P1IN
   60 00000034 7801            LDRB             r1, [r0]
   61 00000036 F011 0F02       TST              r1, TSTmask
   62 0000003A D110            BNE              stateB
   63 0000003C         
   64 0000003C F000 F852       BL               greenON
   65 00000040 F000 F85E       BL               yellowON
   66 00000044 F000 F86A       BL               redON
   67 00000048         
   68 00000048 4844            LDR              R0, =500000
   69 0000004A F000 F848       BL               delayMs
   70 0000004E         
   71 0000004E F000 F85D       BL               yellowOFF
   72 00000052 F000 F869       BL               redOFF
   73 00000056         
   74 00000056 4841            LDR              R0, =500000
   75 00000058 F000 F841       BL               delayMs
   76 0000005C         
   77 0000005C E7E9            B                stateA
   78 0000005E         
   79 0000005E         stateB
   80 0000005E F000 F841       BL               greenON
   81 00000062 F000 F853       BL               yellowOFF
   82 00000066 F000 F85F       BL               redOFF
   83 0000006A         
   84 0000006A         ; to get to stateC
   85 0000006A 483D            LDR              r0, =P2IN
   86 0000006C 7801            LDRB             r1, [r0]
   87 0000006E F011 0F40       TST              r1, FLAmask
   88 00000072 D005            BEQ              stateC
   89 00000074         
   90 00000074         ; to get to stateA
   91 00000074 4838            LDR              r0, =P1IN
   92 00000076 7801            LDRB             r1, [r0]
   93 00000078 F011 0F02       TST              r1, TSTmask
   94 0000007C D0D9            BEQ              stateA
   95 0000007E         
   96 0000007E E7EE            B                stateB
   97 00000080         
   98 00000080         stateC



ARM Macro Assembler    Page 3 


   99 00000080         ; to get to stateE
  100 00000080 4837            LDR              r0, =P2IN
  101 00000082 7801            LDRB             r1, [r0]
  102 00000084 F011 0F80       TST              r1, OLAmask
  103 00000088 D00E            BEQ              stateE
  104 0000008A         
  105 0000008A F000 F831       BL               greenOFF
  106 0000008E F000 F84B       BL               redOFF      ; red shouldnt be o
                                                            n in stateB, but tu
                                                            rn it off as a fail
                                                            safe
  107 00000092 F000 F835       BL               yellowON
  108 00000096         
  109 00000096 4831            LDR              R0, =500000
  110 00000098 F000 F821       BL               delayMs
  111 0000009C         
  112 0000009C F000 F836       BL               yellowOFF
  113 000000A0         
  114 000000A0 482E            LDR              R0, =500000
  115 000000A2 F000 F81C       BL               delayMs
  116 000000A6         
  117 000000A6 E7EB            B                stateC
  118 000000A8         
  119 000000A8         stateE
  120 000000A8         ; to get to stateF
  121 000000A8 482B            LDR              r0, =P1IN
  122 000000AA 7801            LDRB             r1, [r0]
  123 000000AC F011 0F10       TST              r1, ACKmask
  124 000000B0 D00E            BEQ              stateF
  125 000000B2         
  126 000000B2 F000 F81D       BL               greenOFF
  127 000000B6 F000 F829       BL               yellowOFF
  128 000000BA F000 F82F       BL               redON
  129 000000BE         
  130 000000BE 4827            LDR              R0, =500000
  131 000000C0 F000 F80D       BL               delayMs
  132 000000C4         
  133 000000C4 F000 F830       BL               redOFF
  134 000000C8         
  135 000000C8 4824            LDR              R0, =500000
  136 000000CA F000 F808       BL               delayMs
  137 000000CE         
  138 000000CE E7EB            B                stateE
  139 000000D0         
  140 000000D0         stateF
  141 000000D0 F000 F80E       BL               greenOFF
  142 000000D4 F000 F81A       BL               yellowOFF
  143 000000D8 F000 F820       BL               redON
  144 000000DC         
  145 000000DC E7F8            B                stateF
  146 000000DE         
  147 000000DE         ; ------------------------------------------------------
                       ------------------------
  148 000000DE         ; SUBROUTINES
  149 000000DE         delayMs
  150 000000DE         
  151 000000DE 3801    L1      SUBS             R0, #1      ; inner loop
  152 000000E0 D1FD            BNE              L1
  153 000000E2 4770            BX               LR



ARM Macro Assembler    Page 4 


  154 000000E4         
  155 000000E4         greenON
  156 000000E4 481B            LDR              R0, =P2OUT  ; load Output Data 
                                                            Reg in R1
  157 000000E6 7801            LDRB             R1, [R0]
  158 000000E8 F041 0102       ORR              R1, #2      ; set bit 0
  159 000000EC 7001            STRB             R1, [R0]    ; store back to Out
                                                            put Data Reg
  160 000000EE 4770            BX               LR
  161 000000F0         
  162 000000F0         greenOFF
  163 000000F0 4818            LDR              R0, =P2OUT  ; load Output Data 
                                                            Reg in R1
  164 000000F2 7801            LDRB             R1, [R0]
  165 000000F4 F06F 0202       MVN              R2, #2      ; load complement o
                                                            f bit 0 mask
  166 000000F8 EA01 0102       AND              R1, R2      ; clear bit 0
  167 000000FC 7001            STRB             R1, [R0]    ; store back to Out
                                                            put Data Reg
  168 000000FE 4770            BX               LR
  169 00000100         
  170 00000100         yellowON
  171 00000100 4814            LDR              R0, =P2OUT  ; load Output Data 
                                                            Reg in R1
  172 00000102 7801            LDRB             R1, [R0]
  173 00000104 F041 0110       ORR              R1, YELLOWmask
  174 00000108 7001            STRB             R1, [R0]    ; store back to Out
                                                            put Data Reg
  175 0000010A 4770            BX               LR
  176 0000010C         
  177 0000010C         yellowOFF
  178 0000010C 4811            LDR              R0, =P2OUT  ; load Output Data 
                                                            Reg in R1
  179 0000010E 7801            LDRB             R1, [R0]
  180 00000110 F06F 0210       MVN              R2, YELLOWmask ; load complemen
                                                            t of bit 0 mask
  181 00000114 EA01 0102       AND              R1, R2      ; clear bit 0
  182 00000118 7001            STRB             R1, [R0]    ; store back to Out
                                                            put Data Reg
  183 0000011A 4770            BX               LR
  184 0000011C         
  185 0000011C         redON
  186 0000011C 4811            LDR              R0, =P1OUT  ; load Output Data 
                                                            Reg in R1
  187 0000011E 7801            LDRB             R1, [R0]
  188 00000120 F041 0101       ORR              R1, #1      ; set bit 0
  189 00000124 7001            STRB             R1, [R0]    ; store back to Out
                                                            put Data Reg
  190 00000126 4770            BX               LR
  191 00000128         
  192 00000128         redOFF
  193 00000128 480E            LDR              R0, =P1OUT  ; load Output Data 
                                                            Reg in R1
  194 0000012A 7801            LDRB             R1, [R0]
  195 0000012C F06F 0201       MVN              R2, #1      ; load complement o
                                                            f bit 0 mask
  196 00000130 EA01 0102       AND              R1, R2      ; clear bit 0
  197 00000134 7001            STRB             R1, [R0]    ; store back to Out
                                                            put Data Reg



ARM Macro Assembler    Page 5 


  198 00000136 4770            BX               LR
  199 00000138         
  200 00000138         allOFF
  201 00000138 4806            LDR              R0, =P2OUT  ; load Output Data 
                                                            Reg in R1
  202 0000013A 7801            LDRB             R1, [R0]
  203 0000013C F06F 0207       MVN              R2, #7      ; load complement o
                                                            f bit 0 mask
  204 00000140 EA01 0102       AND              R1, R2      ; clear bit 0
  205 00000144 7001            STRB             R1, [R0]    ; store back to Out
                                                            put Data Reg
  206 00000146 4770            BX               LR
  207 00000148         
  208 00000148                 END
              40004C05 
              40004C04 
              40004C07 
              40004C03 
              40004C00 
              0007A120 
              40004C01 
              40004C02 
Command Line: --debug --xref --diag_suppress=9931 --cpu=Cortex-M4.fp --apcs=int
erwork --depend=.\objects\asm_main.d -o.\objects\asm_main.o -I.\RTE\_Target_1 -
IC:\Users\fssoh\AppData\Local\Arm\Packs\ARM\CMSIS\5.6.0\CMSIS\Core\Include -IC:
\Users\fssoh\AppData\Local\Arm\Packs\TexasInstruments\MSP432P4xx_DFP\3.2.6\Devi
ce\Include --predefine="__EVAL SETA 1" --predefine="__UVISION_VERSION SETA 528"
 --predefine="_RTE_ SETA 1" --predefine="__MSP432P401R__ SETA 1" --list=.\listi
ngs\asm_main.lst asm_main.s



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

.text 00000000

Symbol: .text
   Definitions
      At line 23 in file asm_main.s
   Uses
      None
Comment: .text unused
L1 000000DE

Symbol: L1
   Definitions
      At line 151 in file asm_main.s
   Uses
      At line 152 in file asm_main.s
Comment: L1 used once
allOFF 00000138

Symbol: allOFF
   Definitions
      At line 200 in file asm_main.s
   Uses
      At line 48 in file asm_main.s
Comment: allOFF used once
asm_main 00000000

Symbol: asm_main
   Definitions
      At line 26 in file asm_main.s
   Uses
      At line 24 in file asm_main.s
Comment: asm_main used once
delayMs 000000DE

Symbol: delayMs
   Definitions
      At line 149 in file asm_main.s
   Uses
      At line 69 in file asm_main.s
      At line 75 in file asm_main.s
      At line 110 in file asm_main.s
      At line 115 in file asm_main.s
      At line 131 in file asm_main.s
      At line 136 in file asm_main.s

greenOFF 000000F0

Symbol: greenOFF
   Definitions
      At line 162 in file asm_main.s
   Uses
      At line 105 in file asm_main.s
      At line 126 in file asm_main.s
      At line 141 in file asm_main.s

greenON 000000E4

Symbol: greenON
   Definitions



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Relocatable symbols

      At line 155 in file asm_main.s
   Uses
      At line 64 in file asm_main.s
      At line 80 in file asm_main.s

loop 00000028

Symbol: loop
   Definitions
      At line 47 in file asm_main.s
   Uses
      At line 53 in file asm_main.s
Comment: loop used once
redOFF 00000128

Symbol: redOFF
   Definitions
      At line 192 in file asm_main.s
   Uses
      At line 72 in file asm_main.s
      At line 82 in file asm_main.s
      At line 106 in file asm_main.s
      At line 133 in file asm_main.s

redON 0000011C

Symbol: redON
   Definitions
      At line 185 in file asm_main.s
   Uses
      At line 66 in file asm_main.s
      At line 128 in file asm_main.s
      At line 143 in file asm_main.s

stateA 00000032

Symbol: stateA
   Definitions
      At line 57 in file asm_main.s
   Uses
      At line 77 in file asm_main.s
      At line 94 in file asm_main.s

stateB 0000005E

Symbol: stateB
   Definitions
      At line 79 in file asm_main.s
   Uses
      At line 51 in file asm_main.s
      At line 62 in file asm_main.s
      At line 96 in file asm_main.s

stateC 00000080

Symbol: stateC
   Definitions
      At line 98 in file asm_main.s
   Uses



ARM Macro Assembler    Page 3 Alphabetic symbol ordering
Relocatable symbols

      At line 88 in file asm_main.s
      At line 117 in file asm_main.s

stateE 000000A8

Symbol: stateE
   Definitions
      At line 119 in file asm_main.s
   Uses
      At line 103 in file asm_main.s
      At line 138 in file asm_main.s

stateF 000000D0

Symbol: stateF
   Definitions
      At line 140 in file asm_main.s
   Uses
      At line 124 in file asm_main.s
      At line 145 in file asm_main.s

yellowOFF 0000010C

Symbol: yellowOFF
   Definitions
      At line 177 in file asm_main.s
   Uses
      At line 71 in file asm_main.s
      At line 81 in file asm_main.s
      At line 112 in file asm_main.s
      At line 127 in file asm_main.s
      At line 142 in file asm_main.s

yellowON 00000100

Symbol: yellowON
   Definitions
      At line 170 in file asm_main.s
   Uses
      At line 65 in file asm_main.s
      At line 107 in file asm_main.s

17 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Absolute symbols

ACKmask 00000010

Symbol: ACKmask
   Definitions
      At line 16 in file asm_main.s
   Uses
      At line 123 in file asm_main.s
Comment: ACKmask used once
FLAmask 00000040

Symbol: FLAmask
   Definitions
      At line 17 in file asm_main.s
   Uses
      At line 39 in file asm_main.s
      At line 44 in file asm_main.s
      At line 87 in file asm_main.s

OLAmask 00000080

Symbol: OLAmask
   Definitions
      At line 18 in file asm_main.s
   Uses
      At line 102 in file asm_main.s
Comment: OLAmask used once
P1DIR 40004C04

Symbol: P1DIR
   Definitions
      At line 2 in file asm_main.s
   Uses
      At line 32 in file asm_main.s
Comment: P1DIR used once
P1IN 40004C00

Symbol: P1IN
   Definitions
      At line 5 in file asm_main.s
   Uses
      At line 59 in file asm_main.s
      At line 91 in file asm_main.s
      At line 121 in file asm_main.s

P1OUT 40004C02

Symbol: P1OUT
   Definitions
      At line 4 in file asm_main.s
   Uses
      At line 186 in file asm_main.s
      At line 193 in file asm_main.s

P1REN 40004C06

Symbol: P1REN
   Definitions
      At line 6 in file asm_main.s
   Uses



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Absolute symbols

      None
Comment: P1REN unused
P2DIR 40004C05

Symbol: P2DIR
   Definitions
      At line 9 in file asm_main.s
   Uses
      At line 27 in file asm_main.s
Comment: P2DIR used once
P2IN 40004C01

Symbol: P2IN
   Definitions
      At line 11 in file asm_main.s
   Uses
      At line 85 in file asm_main.s
      At line 100 in file asm_main.s

P2OUT 40004C03

Symbol: P2OUT
   Definitions
      At line 10 in file asm_main.s
   Uses
      At line 42 in file asm_main.s
      At line 156 in file asm_main.s
      At line 163 in file asm_main.s
      At line 171 in file asm_main.s
      At line 178 in file asm_main.s
      At line 201 in file asm_main.s

P2REN 40004C07

Symbol: P2REN
   Definitions
      At line 8 in file asm_main.s
   Uses
      At line 37 in file asm_main.s
Comment: P2REN used once
TSTmask 00000002

Symbol: TSTmask
   Definitions
      At line 15 in file asm_main.s
   Uses
      At line 61 in file asm_main.s
      At line 93 in file asm_main.s

YELLOWmask 00000010

Symbol: YELLOWmask
   Definitions
      At line 13 in file asm_main.s
   Uses
      At line 173 in file asm_main.s
      At line 180 in file asm_main.s

13 symbols



ARM Macro Assembler    Page 3 Alphabetic symbol ordering
Absolute symbols

367 symbols in table
